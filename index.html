<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tabliczka mno≈ºenia ‚Äì ƒáwiczenia</title>

<style>
body{font-family:Arial,sans-serif;background:#f2f7ff;margin:0}
header{background:#4caf50;color:#fff;padding:15px;text-align:center}
.hidden{display:none}
section{padding:20px}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:15px}
.tile{background:#fff;padding:20px;border-radius:12px;text-align:center;
font-size:18px;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,.2)}
.tile:hover{background:#e8f5e9}
.answers button{margin:8px;padding:12px 18px;font-size:18px;border-radius:10px}
input[type=number]{font-size:18px;padding:8px;width:100px}
.box{background:#fff;padding:15px;border-radius:12px}
button{cursor:pointer}
</style>
</head>

<body>
<header>
<h1>Tabliczka mno≈ºenia do 100</h1>
<p>ƒÜwiczenia</p>
</header>

<section id="menu">
  <div class="grid">
    <div class="tile" onclick="startGame('tiles')">üß© Kafelki</div>
    <div class="tile" onclick="startGame('input')">‚úèÔ∏è Wpisywanie</div>
  </div>
</section>

<section id="game" class="hidden">
  <h2 id="question"></h2>

  <div class="answers" id="answers"></div>

  <div id="inputBox" class="hidden">
    <input type="number" id="userInput">
    <button onclick="checkInput()">OK</button>
  </div>

  <p>Poprawne odpowiedzi: <b id="points">0</b></p>
  <p>Czas odpowiedzi: <b id="time">0</b> s</p>

  <button onclick="endGame()">Zako≈Ñcz grƒô</button>
</section>

<section id="revision" class="hidden">
  <h2>üîÅ Powt√≥rka trudnych zada≈Ñ</h2>
  <h3 id="revQuestion"></h3>

  <div class="answers" id="revAnswers"></div>

  <div id="revInputBox" class="hidden">
    <input type="number" id="revInput">
    <button onclick="checkRevisionInput()">OK</button>
  </div>

  <p id="revInfo"></p>
  <button onclick="showSummary()">Zako≈Ñcz powt√≥rkƒô</button>
</section>

<section id="summary" class="hidden">
  <h2>üìä Podsumowanie</h2>
  <div class="box" id="stats"></div>
  <button onclick="location.reload()">Powr√≥t do menu</button>
</section>

<script>
let a,b,correct,mode,startTime;
let points=0;
let revisionTasks=[];
let revIndex=0;

/* -------- GRA -------- */

function randTask(){
  a=Math.ceil(Math.random()*10);
  b=Math.ceil(Math.random()*10);
  correct=a*b;
}

function startGame(m){
  mode=m;
  points=0;
  revisionTasks=[];
  document.getElementById('points').innerText=0;

  document.getElementById('menu').classList.add('hidden');
  document.getElementById('game').classList.remove('hidden');

  nextTask();
}

function nextTask(){
  randTask();
  startTime=Date.now();

  document.getElementById('question').innerText=`${a} √ó ${b} = ?`;
  document.getElementById('answers').innerHTML='';
  document.getElementById('inputBox').classList.add('hidden');

  if(mode==='tiles'){
    let opts=[correct];
    while(opts.length<4){
      let r=Math.ceil(Math.random()*100);
      if(!opts.includes(r)) opts.push(r);
    }
    opts.sort(()=>Math.random()-0.5);
    opts.forEach(o=>{
      let btn=document.createElement('button');
      btn.innerText=o;
      btn.onclick=()=>check(o);
      document.getElementById('answers').appendChild(btn);
    });
  } else {
    document.getElementById('inputBox').classList.remove('hidden');
  }
}

function check(ans){
  let t=(Date.now()-startTime)/1000;
  document.getElementById('time').innerText=t.toFixed(1);

  if(ans===correct){
    points++;
    document.getElementById('points').innerText=points;
    setTimeout(nextTask,300);
  } else {
    if(!revisionTasks.some(r=>r[0]===a && r[1]===b)){
      revisionTasks.push([a,b,correct]);
    }
    alert("‚ùå B≈ÇƒÖd ‚Äì spr√≥buj jeszcze raz");
  }
}

function checkInput(){
  let v=parseInt(document.getElementById('userInput').value);
  document.getElementById('userInput').value='';
  check(v);
}

/* -------- KONIEC GRY -------- */

function endGame(){
  document.getElementById('game').classList.add('hidden');

  if(revisionTasks.length>0){
    startRevision();
  } else {
    showSummary();
  }
}

/* -------- POWT√ìRKA -------- */

function startRevision(){
  document.getElementById('revision').classList.remove('hidden');
  revIndex=0;
  showRevision();
}

function showRevision(){
  if(revIndex>=revisionTasks.length){
    document.getElementById('revInfo').innerText="‚úÖ Wszystkie zadania opanowane!";
    return;
  }

  let [x,y,res]=revisionTasks[revIndex];
  document.getElementById('revQuestion').innerText=`${x} √ó ${y} = ?`;
  document.getElementById('revAnswers').innerHTML='';
  document.getElementById('revInputBox').classList.add('hidden');

  if(mode==='tiles'){
    let opts=[res];
    while(opts.length<4){
      let r=Math.ceil(Math.random()*100);
      if(!opts.includes(r)) opts.push(r);
    }
    opts.sort(()=>Math.random()-0.5);
    opts.forEach(o=>{
      let btn=document.createElement('button');
      btn.innerText=o;
      btn.onclick=()=>checkRevision(o);
      document.getElementById('revAnswers').appendChild(btn);
    });
  } else {
    document.getElementById('revInputBox').classList.remove('hidden');
  }
}

function checkRevision(ans){
  let res=revisionTasks[revIndex][2];
  if(ans===res){
    revIndex++;
    showRevision();
  } else {
    alert("‚ùå Nadal b≈ÇƒÖd ‚Äì spr√≥buj jeszcze raz");
  }
}

function checkRevisionInput(){
  let v=parseInt(document.getElementById('revInput').value);
  document.getElementById('revInput').value='';
  checkRevision(v);
}

/* -------- PODSUMOWANIE -------- */

function showSummary(){
  document.getElementById('revision').classList.add('hidden');
  document.getElementById('summary').classList.remove('hidden');

  document.getElementById('stats').innerHTML=`
    <p>‚úî Poprawne odpowiedzi: <b>${points}</b></p>
    <p>üîÅ Zadania do powt√≥rki: <b>${revisionTasks.length}</b></p>
  `;
}
</script>
</body>
</html>
